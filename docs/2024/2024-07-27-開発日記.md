---
draft: fale
emoji: ğŸš™
title: é–‹ç™ºæ—¥è¨˜-2024-07-27 / monorepoã§ãƒ«ãƒ¼ãƒˆã®.envã‚’å…±æœ‰ã™ã‚‹
slug: diary-2024-07-27
published_at: 2024-07-27 11:17:09
modified_at: 2024-07-27 11:17:09
tags:
  - npm
  - dotenv-cli
preview: null
type: default
---

## monorepoã§ãƒ«ãƒ¼ãƒˆã®.envã‚’å…±æœ‰ã™ã‚‹

```tree
.
â”œâ”€â”€ packages
â”‚   â”œâ”€â”€ package1
â”‚   â””â”€â”€ package2
â”œâ”€â”€ apps
â”‚   â””â”€â”€ next
â”‚      â”œâ”€â”€ src
â”‚      â””â”€â”€ package.json
â””â”€â”€ .env
```

ä¸Šè¨˜ã®ã‚ˆã†ãªæ§‹æˆã® `./apps/next` ã®Next.jsã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’ `pnpm dev` ã§èµ·å‹•ã—ãŸå ´åˆã«ã€`.env` ã®ç’°å¢ƒå¤‰æ•°ã‚’å‚ç…§ï¼ˆ`process.env.XXXX`ï¼‰ã—ãŸã„å ´åˆã®æ–¹æ³•ã€‚stackoverflowã«ç­”ãˆãŒã‚ã£ãŸã€‚

::link-card[https://stackoverflow.com/questions/75058474/how-to-use-both-root-and-app-level-env-files-with-turborepo]

ä»¥ä¸‹ã¯ã‚³ãƒãƒ³ãƒ‰ã¨package.jsonã®ä¿®æ­£å†…å®¹ãƒ¡ãƒ¢ã€‚

```sh:Terminal
pnpm add -w -D -E dotenv-cli
```

```json:apps/next/package.json
{
  "scripts": {
    "dev": "pnpm with-env next dev",
    "with-env": "dotenv -e ../../.env --"
  },
}
```

## shadcn/uiã®åˆæœŸåŒ–æ™‚ã«ç”Ÿæˆã•ã‚Œã‚‹globals.cssã®.darkã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå‡ºåŠ›ã•ã‚Œãªã„å ´åˆã®å¯¾å¿œæ–¹æ³•

[shadcn/uiã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://ui.shadcn.com/docs/dark-mode/next)é€šã‚Šã«ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®è¨­å®šã‚’ã—ã¦ã„ãŸã‚‰ã†ã¾ããƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚‰ãªã‹ã£ãŸã®ã§å¯¾å¿œæ–¹æ³•ã‚’æ®‹ã—ã¦ãŠãã€‚

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨shadcn/uiã®åˆæœŸåŒ–ã‚’è¡Œã„ã€ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•çš„ã«ä¿®æ­£ã•ã‚Œã‚‹ã€‚

```sh:Terminal
pnpm dlx shadcn-ui@latest init
```

ã“ã®ã¨ã `globals.css` ãŒæ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã•ã‚Œã‚‹ã€‚

```css:globals.css
@layer base {
  :root {
    /* ... */
  }

  .dark { /* [!code highlight]
    /* ... */
  }
}
```

ä¸Šè¨˜ã® `.dark` ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Ÿéš›ã®CSSï¼ˆ`/_next/static/css/app/layout.css`ï¼‰ã«å‡ºåŠ›ã•ã‚Œãªã„å ´åˆãŒã‚ã‚‹ã€‚Tailwind CSSã§ã¯ä½¿ã‚ã‚Œã¦ã„ãªã„classå±æ€§ã¯å‡ºåŠ›ã—ãªã„ã¨ã„ã†ä»•æ§˜ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€‚

### è§£æ±ºç­– ãã®ï¼‘

ãªã®ã§ã€æ¬¡ã®ã‚ˆã†ã« `tailwind.config.ts` ã® `safelist` ã« `'dark'` ã‚’è¿½åŠ ã™ã‚‹ã¨è‰¯ã„ã€‚

```typescript:tailwind.config.ts
const config = {
  safelist: ['dark'],
}
```

### è§£æ±ºç­– ãã®ï¼’

ä»–ã«ã¯æ¬¡ã®ã‚ˆã†ã« `.dark` ã‚’ `:root[class~="dark"]` ã«ç½®ãæ›ãˆã‚‹ã¨ã„ã†æ–¹æ³•ãŒã‚ã‚‹ã€‚

```css:globals.css
@layer base {
  :root {
    /* ... */
  }

  :root[class~="dark"] { /* [!code highlight]
    /* ... */
  }
}
```

### è§£æ±ºç­– ãã®ï¼“

æœ€å¾Œã« `@layer base { ... }` ã®å¤–å´ã«å‡ºã™ã¨ã„ã†å¯¾å¿œæ–¹æ³•ã‚‚ã‚ã‚‹ã€‚

ã“ã‚Œã‚‰ã®æ–¹æ³•ã¯ä»¥ä¸‹ã®å…¬å¼ã®issueã«ã‚³ãƒ¡ãƒ³ãƒˆãŒã¤ã„ã¦ã„ãŸã€‚

::link-card[https://github.com/shadcn-ui/ui/issues/313]

::link-card[https://github.com/shadcn-ui/ui/issues/515]

### ç™ºç”Ÿã—ãªã„çŠ¶æ³

Tailwind CSSã®è¨­å®šã® `content: ['./src/**/*.{ts,tsx}']` ã®å¯¾è±¡ã¨ãªã£ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€æ¬¡ã®ã‚ˆã†ã«ä½•ã‹ã®å±æ€§ã« `dark` ã¨ã„ã†å˜èªãŒå«ã¾ã‚Œã¦ã„ãŸå ´åˆã¯å•é¡Œã¯ç™ºç”Ÿã—ãªã„ï¼ˆCSSãƒ•ã‚¡ã‚¤ãƒ«ã«.darkã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå‡ºåŠ›ã•ã‚Œã‚‹ï¼‰ãŸã‚æ°—ã¥ã‹ãªã‹ã£ãŸã€‚

```tsx
<ToggleGroupItem className="rounded-full" value="dark" aria-label="Toggle dark">
```
